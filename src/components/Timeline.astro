---
interface TimelineItem {
  title: string;
  company?: string;
  location?: string;
  period: string;
  duration?: string;
  description: string;
}

interface Props {
  items: TimelineItem[];
}

const { items } = Astro.props;
---

<div class="timeline-container">
  {items.map((item, index) => (
    <div class="timeline-item" style={`animation-delay: ${index * 0.1}s;`}>
      <!-- Timeline Line & Dot -->
      <div class="timeline-line-wrapper">
        <div class="timeline-dot"></div>
        {index < items.length - 1 && <div class="timeline-line"></div>}
      </div>

      <!-- Content Card -->
      <div class="timeline-content">
        <div class="timeline-header">
          <div class="timeline-title-group">
            <h3 class="timeline-title">{item.title}</h3>
            {item.duration && (
              <span class="timeline-duration">{item.duration}</span>
            )}
          </div>
          {item.company && (
            <div class="timeline-company">
              <svg class="w-4 h-4 text-muted-foreground" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
              </svg>
              <span>{item.company}</span>
            </div>
          )}
        </div>

        <div class="timeline-meta">
          {item.location && (
            <div class="timeline-location">
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              <span>{item.location}</span>
            </div>
          )}
          <div class="timeline-period">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <span>{item.period}</span>
          </div>
        </div>

        <p class="timeline-description">{item.description}</p>
      </div>
    </div>
  ))}
</div>

<style>
  .timeline-container {
    @apply relative space-y-0;
  }

  .timeline-item {
    @apply relative flex gap-6 pb-8 last:pb-0;
    animation: fade-in-up 0.6s ease-out forwards;
  }

  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Timeline Line & Dot */
  .timeline-line-wrapper {
    @apply relative flex flex-col items-center pt-2;
    @apply flex-shrink-0;
    width: 24px;
  }

  .timeline-dot {
    @apply w-4 h-4 rounded-full border-4 bg-background z-10;
    @apply transition-all duration-300;
    border-color: hsl(var(--primary));
    box-shadow: 0 0 0 4px hsl(var(--primary) / 0.1);
  }

  .timeline-item:hover .timeline-dot {
    @apply scale-125;
    box-shadow: 0 0 0 6px hsl(var(--primary) / 0.2);
  }

  .timeline-line {
    @apply w-0.5 flex-1 mt-2;
    background: linear-gradient(
      to bottom,
      hsl(var(--primary) / 0.5),
      hsl(var(--primary) / 0.1)
    );
  }

  /* Content Card */
  .timeline-content {
    @apply flex-1 rounded-lg border bg-card text-card-foreground shadow-sm p-6 space-y-4;
    @apply transition-all duration-300;
  }

  .timeline-item:hover .timeline-content {
    @apply shadow-lg;
    transform: translateX(4px);
  }

  .timeline-header {
    @apply space-y-3;
  }

  .timeline-title-group {
    @apply flex items-start justify-between gap-4 flex-wrap;
  }

  .timeline-title {
    @apply text-xl font-semibold text-foreground;
  }

  .timeline-duration {
    @apply inline-flex items-center px-3 py-1 rounded-full text-xs font-medium;
    @apply bg-primary/10 text-primary border border-primary/20;
    @apply flex-shrink-0;
  }

  .timeline-company {
    @apply flex items-center gap-2 text-sm font-medium text-foreground;
  }

  .timeline-meta {
    @apply flex flex-wrap items-center gap-4 text-sm text-muted-foreground;
  }

  .timeline-location,
  .timeline-period {
    @apply flex items-center gap-1.5;
  }

  .timeline-description {
    @apply text-sm text-muted-foreground leading-relaxed;
  }

  /* Mobile Responsiveness */
  @media (max-width: 640px) {
    .timeline-item {
      @apply gap-4;
    }

    .timeline-line-wrapper {
      width: 20px;
    }

    .timeline-dot {
      @apply w-3 h-3 border-[3px];
    }

    .timeline-content {
      @apply p-4;
    }

    .timeline-title {
      @apply text-lg;
    }

    .timeline-title-group {
      @apply flex-col items-start gap-2;
    }

    .timeline-meta {
      @apply flex-col items-start gap-2;
    }
  }
</style>
